#summary How to create instruments and sound effects

The instrument editor view shows parameters that control the sound synthesis and the instrument program editor.

=Parameters=

=Instrument program=

When an instrument is triggered, the program starts executing from the beginning. The execution speed is independent from the song speed but relative to the routine update frequency. The program period instrument parameter controls how many routine updates it takes to advance the program one step.

A program modifies the played waveform and can be used to create more interesting sounds. The commands are the same as the [Commands track commands]. This means the program can also be thought as a macro: you do not need to enter the same track commands if the instrument executes has the same commands in the program. 

The program can be edited by moving to the program and pressing return on the instruction you want to edit.

The following example is a simple 0-4-7 major arpeggio:

{{{
00 00 0000   set arpeggio note to 0 (the same note as played)
01 01 0004   set arpeggio note to 4 (played note plus 4 semitones)
02 02 0007   set arpeggio note to 7
03 03 FF00   jump back to step 00
}}}

Note that you can also specify the arpeggio notes by using the track command {{{10xy}}}. This makes it possible to use the same instrument to play different arpeggio chords. In the program, you can refer to those two notes with {{00f0}} and {{00f1}}. For the above example, the following program and track data achieves the same:

{{{
00 00 0000   set arpeggio note to 0 (the same note as played)
01 01 00F0   set arpeggio note to external arpeggio note 0 
02 02 00F1   set arpeggio note to external arpeggio note 1
03 03 FF00   jump back to step 00
}}}

And the track data:

{{{
C-4 00 ... 0047
}}}

*Tip:* A handy way to debug instrument programs is to set the program period (execution speed) to 10 or more and then pay attention to the little marker that shows current program tick. That way you'll notice if e.g. a jump doesn't point to the correct command.

==Combining commands==

Use {{{Space}}} to combine the currently selected command with the command that is directly below it. This means klystrack sees the combined commands as one, meaning they are executed at the same time. 

{{{
00 00 000C ,   set arpeggio note to +12 semitones  (press Space here)
01    0918 '   set PW
02 01 0000 ,   set arpeggio note to +0 semitones   (press Space here)  <--,
03    0102 |   portamento up by 2/256 semitones    (press Space here)     |
04    0710 '   PW down by 10                                              |
05 02 FF02     jump to location 02 ---------------------------------------'
}}}

Note how the second column doesn't follow the leftmost column as it did in the previous examples. This is because some of the commands are no longer executed separately. Also note that the jump is to the number in the _leftmost_ column.